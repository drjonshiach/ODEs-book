
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Implicit Runge-Kutta Methods &#8212; Runge-Kutta Methods and Computational Linear Algebra</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Deriving implicit Runge-Kutta methods" href="3.1_Deriving_IRK_methods.html" />
    <link rel="prev" title="Explicit Runge-Kutta Methods Exercises" href="2.5_ERK_Exercises.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Runge-Kutta Methods and Computational Linear Algebra</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0_Introduction.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Runge-Kutta Methods
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="1.0_IVPs.html">
   1. Initial Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="1.1_Taylor_Series.html">
     The Taylor Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1.2_Euler_Method.html">
     The Euler method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1.3_Error_Analysis.html">
     Error analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1.4_RK2.html">
     The Second-Order Runge-Kutta Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1.5_Higher_Order_ODEs.html">
     Higher-order Ordinary Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1.6_IVP_Summary.html">
     Initial Value Problems Chapter Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1.7_Exercises.html">
     Initial Value Problems Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2.0_ERKs.html">
   2. Explicit Runge-Kutta Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="2.1_ERK_Derivation.html">
     Derivation of Explicit Runge-Kutta Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.2_RK4_Derivation.html">
     Derivation of a fourth-order explicit Runge-Kutta method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.3_Solving_IVPs_using_ERK_methods.html">
     Solving initial value problems using explicit Runge-Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.4_ERK_Summary.html">
     Chapter Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.5_ERK_Exercises.html">
     Explicit Runge-Kutta Methods Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   3. Implicit Runge-Kutta Methods
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="3.1_Deriving_IRK_methods.html">
     Deriving implicit Runge-Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3.2_Solving_IVPs_using_IRK_methods.html">
     Solving initial value problems using implicit Runge-Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3.3_IRK_summary.html">
     Chapter Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3.4_IRK_exercises.html">
     Implicit Runge-Kutta Methods Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="4.0_Stability.html">
   4. Stability
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="4.1_Stability_functions.html">
     Stability functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4.2_RK_stability_function.html">
     Stability function of a Runge-Kutta method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4.3_IRK_stability_function.html">
     Stability functions of implicit methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4.4_Stability_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4.5_Stability_exercises.html">
     Stability Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="5.0_BVPs.html">
   5. Boundary Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="5.1_Shooting_method.html">
     The shooting method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5.2_Finite_difference_method.html">
     The finite-difference method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5.3_BVP_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5.4_BVP_exercises.html">
     Boundary value problems exercises
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solving Linear Systems of Equations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="6.0_Direct_methods.html">
   6. Direct Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="6.1_LU_decomposition.html">
     LU decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6.2_LUP_decomposition.html">
     LUP decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6.3_Cholesky_decomposition.html">
     Cholesky decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6.4_QR_decomposition.html">
     QR decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6.5_Direct_methods_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6.6_Direct_methods_exercises.html">
     Direct methods exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="7.0_Indirect_methods.html">
   7. Indirect Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="7.1_Jacobi_method.html">
     Jacobi method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="7.2_Gauss_Seidel_method.html">
     Gauss-Seidel method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="7.3_Convergence_of_indirect_methods.html">
     Convergence of indirect methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="7.4_SOR_method.html">
     The Successive Over Relaxation (SOR) method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="7.5_Indirect_methods_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="7.6_Indirect_methods_exercises.html">
     Indirect methods exercises
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/drjonshiach/ODEs_book/main?urlpath=tree/3.0_IRKs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/3.0_IRKs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Implicit Runge-Kutta methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#determining-the-order-of-an-implicit-runge-kutta-method">
   Determining the order of an implicit Runge-Kutta method
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>3. Implicit Runge-Kutta Methods</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Implicit Runge-Kutta methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#determining-the-order-of-an-implicit-runge-kutta-method">
   Determining the order of an implicit Runge-Kutta method
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="implicit-runge-kutta-methods">
<span id="irk-chapter"></span><h1>3. Implicit Runge-Kutta Methods<a class="headerlink" href="#implicit-runge-kutta-methods" title="Permalink to this headline">#</a></h1>
<p><strong>Learning outcomes</strong></p>
<p>On successful completion of this chapter readers will be able to:</p>
<ul class="simple">
<li><p>determine the <a class="reference internal" href="#order-of-irk-section"><span class="std std-ref">order of an implicit Runge-Kutta method</span></a>;</p></li>
<li><p>derive <a class="reference internal" href="3.1_Deriving_IRK_methods.html#gauss-legendre-derivation"><span class="std std-ref">Gauss-Legendre</span></a>, <a class="reference internal" href="3.1_Deriving_IRK_methods.html#radau-derivation"><span class="std std-ref">Radau</span></a>, <a class="reference internal" href="3.1_Deriving_IRK_methods.html#dirk-derivation"><span class="std std-ref">DIRK</span></a> and <a class="reference internal" href="3.1_Deriving_IRK_methods.html#sdirk-derivation"><span class="std std-ref">SDIRK</span></a> implicit Runge-Kutta methods;</p></li>
<li><p>apply <a class="reference internal" href="3.2_Solving_IVPs_using_IRK_methods.html#solving-ivps-using-irk-methods-section"><span class="std std-ref">implicit Runge-Kutta methods to solve initial value problems</span></a>.</p></li>
</ul>
<hr class="docutils" />
<div class="section" id="id1">
<h2>Implicit Runge-Kutta methods<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>Runge-Kutta methods can be either an explicit or implicit methods depending on the functions used to calculate the stage values. We have seen in the <a class="reference internal" href="2.0_ERKs.html#erk-chapter"><span class="std std-ref">previous section on explicit methods</span></a> that they are straightforward to apply, however they are not always suitable for solving ODEs that are <strong>stiff</strong> (see <a class="reference internal" href="4.0_Stability.html#stability-chapter"><span class="std std-ref">next chapter on stability</span></a>). This is why we need to also consider implicit methods.</p>
<p>Recall that the <a class="reference internal" href="2.0_ERKs.html#rk-definition"><span class="std std-ref">general form of a Runge-Kutta method</span></a> to solve a first-order ODE <span class="math notranslate nohighlight">\(y'=f(t,y)\)</span> is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
   y_{n+1} &amp;=y_n + h \sum_{i=1}^s b_i k_i,\\
   k_i &amp;=f(t_n +c_i h,y_n + h \sum_{j=1}^s a_{ij} k_j).
\end{align*}\]</div>
<p>Expanding out the stage value functions we have</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    k_1 &amp;= f(t_n + c_1 h, y_n + h (a_{11} k_1 + a_{12} k_2 + \cdots + a_{1s} k_s), \\
    k_2 &amp;= f(t_n + c_2 h, y_n + h (a_{21} k_1 + a_{22} k_2 + \cdots + a_{2s} k_s), \\
    &amp; \vdots \\
    k_s &amp;= f(t_n + c_1 h, y_n + h (a_{s1} k_1 + a_{s2} k_2 + \cdots + a_{ss} k_s).
\end{align*}\]</div>
<p>The value of <span class="math notranslate nohighlight">\(k_1\)</span> appears withing the function on the right-hand side of <span class="math notranslate nohighlight">\(k_1\)</span> and similar for the other stage values. This means these functions are implicit functions hence we have an implicit Runge-Kutta method. The Butcher tableau for an implicit method is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
   \begin{array}{c|cccc}
      c_1  &amp; a_{11}  &amp; a_{12}  &amp; \cdots  &amp; a_{1s} \\
      c_2  &amp; a_{21}  &amp; a_{22}  &amp; \cdots  &amp; a_{2s} \\
      \vdots  &amp; \vdots  &amp; \vdots  &amp; \ddots  &amp; \vdots \\
      c_s  &amp; a_{s1}  &amp; a_{s2}  &amp; \cdots  &amp; a_{ss} \\ \hline
       &amp; b_1  &amp; b_2  &amp; \cdots  &amp; b_s 
      \end{array}
\end{align*}\]</div>
<p>Note that the <span class="math notranslate nohighlight">\(A\)</span> matrix in the upper right-hand region of an implicit method can have non-zero elements in them main diagonal and upper triangular region whereas the <span class="math notranslate nohighlight">\(A\)</span> matrix for an explicit method has non-zero elements in the lower triangular region only.</p>
</div>
<div class="section" id="determining-the-order-of-an-implicit-runge-kutta-method">
<span id="order-of-irk-section"></span><h2>Determining the order of an implicit Runge-Kutta method<a class="headerlink" href="#determining-the-order-of-an-implicit-runge-kutta-method" title="Permalink to this headline">#</a></h2>
<p>One of the differences between implicit and explicit methods is that an implicit method can achieve the same accuracy as an explicit method but using fewer stages. To determine the order of an implicit method we need to consider the <strong>order conditions</strong> that govern the values of <span class="math notranslate nohighlight">\(a_{ij}\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(c_i\)</span> which are</p>
<div class="note admonition" id="bk-ck-dk-order-conditions">
<p class="admonition-title">Definition: <span class="math notranslate nohighlight">\(B(k)\)</span>, <span class="math notranslate nohighlight">\(C(k)\)</span> and <span class="math notranslate nohighlight">\(D(k)\)</span> order conditions </p>
<div class="amsmath math notranslate nohighlight" id="equation-9fd7cd3c-5452-42f4-90d8-4cc6b6fadd9e">
<span class="eqno">(16)<a class="headerlink" href="#equation-9fd7cd3c-5452-42f4-90d8-4cc6b6fadd9e" title="Permalink to this equation">#</a></span>\[\begin{align}
  B(k): &amp;&amp; \sum_{i=1}^s b_i c_i^{j-1} = &amp; \frac{1}{j}, &amp; j&amp;=1\ldots k, \\
  C(k): &amp;&amp; \sum_{j=1}^s a_{ij} c_j^{\ell-1} = &amp; \frac{1}{\ell}c_i^{\ell} , &amp; i&amp;=1 \ldots s, &amp; \ell &amp;=1 \ldots k,\\
  D(k): &amp;&amp; \sum_{i=1}^s b_i c_i^{\ell-1} a_{ij} = &amp; \frac{1}{\ell}b_j (1-c_j^{\ell}), &amp; j&amp;=1 \ldots s, &amp; \ell &amp;=1 \ldots k.
\end{align}\]</div>
</div>
<p>If <span class="math notranslate nohighlight">\(G(k)\)</span> represents the fact that a given implicit method has order <span class="math notranslate nohighlight">\(k\)</span> then it can be shown that</p>
<div class="math notranslate nohighlight">
\[B(k)\; \mathsf{and} \; C(\lfloor \frac{k}{2} \rfloor ) \; \mathsf{and} \; D(\lfloor \frac{k}{2} \rfloor ) \Longrightarrow G(k)\]</div>
<p>So to determine the order of an IRK method we need to do the following</p>
<ul class="simple">
<li><p>Find the highest value of <span class="math notranslate nohighlight">\(k\)</span> for which <span class="math notranslate nohighlight">\(B(k)\)</span> is satisfied;</p></li>
<li><p>If <span class="math notranslate nohighlight">\(C(\lfloor \frac{k}{2} \rfloor)\)</span> and <span class="math notranslate nohighlight">\(D(\lfloor \frac{k}{2} \rfloor)\)</span> are satisfied</p>
<ul>
<li><p>the IRK has order <span class="math notranslate nohighlight">\(k\)</span>;</p></li>
</ul>
</li>
<li><p>else</p>
<ul>
<li><p>reduce <span class="math notranslate nohighlight">\(k\)</span> by 1 and check <span class="math notranslate nohighlight">\(C(\lfloor \frac{k}{2} \rfloor)\)</span> and <span class="math notranslate nohighlight">\(D(\lfloor \frac{k}{2} \rfloor)\)</span> again.</p></li>
</ul>
</li>
</ul>
<p>If no value of <span class="math notranslate nohighlight">\(k&gt;0\)</span> satisfies <span class="math notranslate nohighlight">\(B(k)\)</span>, <span class="math notranslate nohighlight">\(C(\lfloor \frac{k}{2} \rfloor)\)</span> and <span class="math notranslate nohighlight">\(D(\lfloor \frac{k}{2} \rfloor)\)</span> then it isn’t a valid Runge-Kutta method.</p>
<div class="seealso admonition">
<p class="admonition-title">Example 3.1</p>
<p>Determine the order of the following IRK method</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \begin{array}{c|cc}
          \frac{1}{4} &amp; \frac{1}{4} &amp; 0 \\
          \frac{3}{4} &amp; \frac{1}{2} &amp; \frac{1}{4} \\ \hline
          &amp; \frac{1}{2} &amp; \frac{1}{2}
    \end{array}
\end{align*}\]</div>
<p>Checking the <span class="math notranslate nohighlight">\(B(k)\)</span> order condition:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  j &amp;=1: &amp; LHS &amp;= b_1 c_1^0 + b_2 c_2^0 = \frac{1}{2}(1)+\frac{1}{2}(1)=1, \\
  &amp;&amp; RHS &amp;= 1,\\
  j &amp;=2: &amp; LHS &amp;= b_1 c_1^1 + b_2 c_2^1 = \frac{1}{2}\left(\frac{1}{4}\right)+\frac{1}{2}\left(\frac{3}{4}\right)=\frac{1}{2}, \\
  &amp;&amp; RHS &amp;= \frac{1}{2},\\
  j &amp;=3: &amp; LHS &amp;= b_1 c_1^2 + b_2 c_2^2 = \frac{1}{2}{\left(\frac{1}{4}\right)}^2 +\frac{1}{2}{\left(\frac{3}{4}\right)}^2 = \frac{5}{16}, \\
  &amp;&amp; RHS &amp;= \frac{1}{3}.
\end{align*}\]</div>
<p>So since <span class="math notranslate nohighlight">\(LHS=RHS\)</span> up to <span class="math notranslate nohighlight">\(j=2\)</span> the <span class="math notranslate nohighlight">\(B(2)\)</span> condition is satisfied. Now we need to check whether <span class="math notranslate nohighlight">\(C(\lfloor \frac{2}{2} \rfloor)=C(1)\)</span> order condition is satisfied. Note that <span class="math notranslate nohighlight">\(\ell = 1\)</span> (if <span class="math notranslate nohighlight">\(k \geq 2\)</span> then we would need to check <span class="math notranslate nohighlight">\(i = 1, 2, \ldots \ell\)</span> for each <span class="math notranslate nohighlight">\(\ell = 1, 2, \ldots\)</span>)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  i &amp;= 1, &amp; LHS&amp;=a_{11} c_1^0 + a_{12} c_2^0 =\frac{1}{4}(1)+0(1)=\frac{1}{4}, \\
  &amp;&amp; RHS &amp;= \frac{1}{\ell}c_1^{\ell} =\frac{1}{4},\\
  i &amp;= 2, &amp; LHS&amp;=a_{21} c_1^0 + a_{22} c_2^0 =\frac{1}{2}(1)+\frac{1}{4}(1)=\frac{3}{4}, \\
  &amp;&amp; RHS &amp;= \frac{1}{\ell}c_2^{\ell} =\frac{3}{4}.
\end{align*}\]</div>
<p>So the <span class="math notranslate nohighlight">\(C(1)\)</span> order condition is satisfied. Now we need to check whether the <span class="math notranslate nohighlight">\(D(1)\)</span> order condition is satisfied</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  j &amp;= 1, &amp; LHS &amp;= b_1 c_1^0 a_{11} +b_2 c_2^0 a_{21} =\frac{1}{2}(1)\left(\frac{1}{4}\right)+\frac{1}{2}(1)\left(\frac{1}{2}\right)=\frac{3}{8},\\
  &amp;&amp; RHS &amp;= \frac{1}{\ell}b_1 (1-c_1^{\ell})=\frac{1}{2}\left(1-\frac{1}{4}\right)=\frac{3}{8},\\
  j&amp;=2, &amp; LHS&amp;=b_1 c_1^0 a_{12} +b_2 c_2^0 a_{22} =\frac{1}{2}(1)(0)+\frac{1}{2}(1)\left(\frac{1}{4}\right)=\frac{1}{8},\\
  &amp;&amp; RHS&amp;=\frac{1}{\ell }b_2 (1 - c_2^{\ell})=\frac{1}{2}\left(1-\frac{3}{4}\right)=\frac{1}{8}.
\end{align*}\]</div>
<p>So the <span class="math notranslate nohighlight">\(D(k)\)</span> order condition is satisfied up to <span class="math notranslate nohighlight">\(k=2\)</span>. Therefore since <span class="math notranslate nohighlight">\(B(2)\)</span>, <span class="math notranslate nohighlight">\(C(1)\)</span> and <span class="math notranslate nohighlight">\(D(1)\)</span> are all satisfied this IRK method is order 2.</p>
</div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2.5_ERK_Exercises.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Explicit Runge-Kutta Methods Exercises</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3.1_Deriving_IRK_methods.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Deriving implicit Runge-Kutta methods</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr Jon Shiach<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>