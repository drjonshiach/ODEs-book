Traceback (most recent call last):
  File "C:\Users\Jon\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\Jon\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jon\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\jupyter_core\utils\__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.1776.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\Jon\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "C:\Users\Jon\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\Jon\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import numpy as np
import subprocess 

def table_row(string, k, x, r):
    string += f"| {k} |"
    for i in range(len(x)):
        string += f"{x[i]:9.6f} | "
    string += f"{max(abs(r)):0.2e} |\n"

    return string

def jacobi_table(A, b, tol=1e-4):
    n = len(b)
    x = np.zeros(n)
    maxiter = 100
    r = b - np.dot(A, x)
    
    string =  f"| $k$ |"
    for i in range(n):
        string += f" $x_{i+1}$ | "
    string += " max residual |\n"
    string += "|:--:|"
    for i in range(n+1):
        string += ":--:|"
    string += "\n"

    string  = table_row(string, 0, x, r)

    for k in range(1, maxiter):
        xold = np.copy(x)
        for i in range(n):
            sum_ = 0
            for j in range(n):
                if i != j:
                    sum_ += A[i,j] * xold[j]
        
            x[i] = (b[i] - sum_) / A[i,i]
            
        r = b - np.dot(A, x)

        if k < 10:
            string  = table_row(string, k, x, r)

        if max(abs(r)) < tol:
            break
    

    string += "| $\\vdots$ |"
    for i in range(n + 1):
        string += " $\\vdots$ | "
    string += " \n"

    string  = table_row(string, k, x, r)

    return string


def jacobi_latex(A, b, tol=1e-4):
    n = len(b)
    x = np.zeros(n)
    maxiter = 100
    ordinal = ["first", "second", "third"]
    string =  "The Jacobi method for this system is\n\n"
    string += "$$ \\begin{align*}\n"
    for i in range(n):
        string += f"    x_{{{i+1}}}^{{(k+1)}} &= \\frac{{1}}{{{A[i,i]}}} \\left( {b[i]}"
        for j in range(n):
            if i == j:
                continue
            if A[i,j] == 1:
                string += f" - x_{{{j+1}}}"
            elif A[i,j] == -1:
                string += f" + x_{{{j+1}}}"
            elif A[i,j] < 0:
                string += f" + {-A[i,j]} x_{{{j+1}}}"
            elif A[i,j] > 0:
                string += f" - {A[i,j]} x_{{{j+1}}}"
            if A[i,j] != 0:
                string += f"^{{(k)}}"
        
        if i == n - 1:
            string += " \\right). \n"
        else:
            string += " \\right), \\\ \n"
            
    string += "\\end{align*} $$ \n\n"
    string += "Using starting values of $\\mathbf{x} = \\mathbf{0}$. "
        
    for k in range(2):
        xo = np.copy(x)
        for i in range(n):
            s = b[i]
            for j in range(n):
                if i != j:
                    s -= A[i,j] * xo[j]
        
            x[i] = s / A[i,i]
            
        r = b - np.dot(A, x)   
        
        string += f"Calculating the {ordinal[k]} iteration\n\n"
        string += "$$ \\begin{align*}\n"
        for i in range(n):
            string += rf"    x_{{{i+1}}}^{{({k+1})}} &= \frac{{1}}{{{A[i,i]}}} \left( {b[i]}"
            for j in range(n):
                if i == j:
                    continue
                if A[i,j] == 1:
                    if xo[j] == 0:
                        string += f" - 0 "
                    elif xo[j] > 0:
                        string += f" + {xo[j]} "
                    else:
                        string += f" {xo[j]} "
                elif A[i,j] == -1:
                    if xo[j] == 0:
                        string += f" + 0 "
                    elif xo[j] > 0:
                        string += f" + {xo[j]} "
                    else:
                        string += f" {xo[j]} "
                elif A[i,j] < 0:
                    if xo[j] == 0:
                        string += f" + {-A[i,j]} (0) "
                    elif xo[j] > 0:
                        string += f" + {-A[i,j]}({xo[j]}) "
                    else:
                        string += f" - {-A[i,j]}({-xo[j]}) "
                elif A[i,j] > 0:
                    if xo[j] == 0:
                        string += f" - {A[i,j]} (0) "
                    elif xo[j] > 0:
                        string += f" - {A[i,j]}({xo[j]}) "
                    else:
                        string += f" + {A[i,j]}({-xo[j]}) "

            if i == n - 1:
                string += f" \\right) = {x[i]}. \n"
            else:
                string += f" \\right) = {x[i]}, \\\ \n"
        
        string += "\\end{align*} $$\n\nCalculate the residual\n\n"
        string += "$$ \\begin{align*} \n"
        string += f"    \\mathbf{{r}}^{{({k+1})}} = \\mathbf{{b}} - A \\mathbf{{x}}^{{(1)}} = \n"
        string += "    \\begin{pmatrix}"
        for i in range(n):
            string += f" {b[i]}"
            if i < n - 1:
                string += " \\\ "
        string += " \\end{pmatrix} - \n"

        string += "    \\begin{pmatrix}"
        for i in range(n):
            for j in range(n):
                string += f" {A[i,j]}"
                if j < n - 1:
                    string += " &"
            if i < n - 1:
                string += " \\\ "
        string += " \\end{pmatrix}\n"
        string += "    \\begin{pmatrix}"
        for i in range(n):
            string += f" {x[i]}"
            if i < n - 1:
                string += " \\\ "
        string += " \\end{pmatrix} = \n"

        string += "    \\begin{pmatrix}"
        for i in range(n):
            string += f" {r[i]}"
            if i < n - 1:
                string += " \\\ "
        string += "    \\end{pmatrix}.\n"
        string += "\\end{align*} $$\n\n"
        string += f"Since $\\max(| \\mathbf{{r}}^{{({k+1})}} |) = {max(abs(r))} > 10^{{-4}}$ we continue iterating. "
    
    return string
        
# Define linear system
A = np.array([[4, 3, 0], [3, 4, -1], [0, -1, 4]])
b = np.array([-2, -8, 14])

# Solve linear system
string = ""
string += jacobi_latex(A, b)

string += "The Jacobi method was iterated until $\\max(|\\mathbf{r}|) < 10^{-4}$ and a selection of the iteration values are given in the table below.\n\n"

string += jacobi_table(A, b)

string += "\n:::\n::::"

print(string)
subprocess.run("pbcopy", text=True, input=string)
------------------

----- stdout -----
The Jacobi method for this system is

$$ \begin{align*}
    x_{1}^{(k+1)} &= \frac{1}{4} \left( -2 - 3 x_{2}^{(k)} \right), \\ 
    x_{2}^{(k+1)} &= \frac{1}{4} \left( -8 - 3 x_{1}^{(k)} + x_{3}^{(k)} \right), \\ 
    x_{3}^{(k+1)} &= \frac{1}{4} \left( 14 + x_{2}^{(k)} \right). 
\end{align*} $$ 

Using starting values of $\mathbf{x} = \mathbf{0}$. Calculating the first iteration

$$ \begin{align*}
    x_{1}^{(1)} &= \frac{1}{4} \left( -2 - 3 (0)  \right) = -0.5, \\ 
    x_{2}^{(1)} &= \frac{1}{4} \left( -8 - 3 (0)  + 0  \right) = -2.0, \\ 
    x_{3}^{(1)} &= \frac{1}{4} \left( 14 + 0  \right) = 3.5. 
\end{align*} $$

Calculate the residual

$$ \begin{align*} 
    \mathbf{r}^{(1)} = \mathbf{b} - A \mathbf{x}^{(1)} = 
    \begin{pmatrix} -2 \\  -8 \\  14 \end{pmatrix} - 
    \begin{pmatrix} 4 & 3 & 0 \\  3 & 4 & -1 \\  0 & -1 & 4 \end{pmatrix}
    \begin{pmatrix} -0.5 \\  -2.0 \\  3.5 \end{pmatrix} = 
    \begin{pmatrix} 6.0 \\  5.0 \\  -2.0    \end{pmatrix}.
\end{align*} $$

Since $\max(| \mathbf{r}^{(1)} |) = 6.0 > 10^{-4}$ we continue iterating. Calculating the second iteration

$$ \begin{align*}
    x_{1}^{(2)} &= \frac{1}{4} \left( -2 + 3(2.0)  \right) = 1.0, \\ 
    x_{2}^{(2)} &= \frac{1}{4} \left( -8 + 3(0.5)  + 3.5  \right) = -0.75, \\ 
    x_{3}^{(2)} &= \frac{1}{4} \left( 14 -2.0  \right) = 3.0. 
\end{align*} $$

Calculate the residual

$$ \begin{align*} 
    \mathbf{r}^{(2)} = \mathbf{b} - A \mathbf{x}^{(1)} = 
    \begin{pmatrix} -2 \\  -8 \\  14 \end{pmatrix} - 
    \begin{pmatrix} 4 & 3 & 0 \\  3 & 4 & -1 \\  0 & -1 & 4 \end{pmatrix}
    \begin{pmatrix} 1.0 \\  -0.75 \\  3.0 \end{pmatrix} = 
    \begin{pmatrix} -3.75 \\  -5.0 \\  1.25    \end{pmatrix}.
\end{align*} $$

Since $\max(| \mathbf{r}^{(2)} |) = 5.0 > 10^{-4}$ we continue iterating. The Jacobi method was iterated until $\max(|\mathbf{r}|) < 10^{-4}$ and a selection of the iteration values are given in the table below.

| $k$ | $x_1$ |  $x_2$ |  $x_3$ |  max residual |
|:--:|:--:|:--:|:--:|:--:|
| 0 | 0.000000 |  0.000000 |  0.000000 | 1.40e+01 |
| 1 |-0.500000 | -2.000000 |  3.500000 | 6.00e+00 |
| 2 | 1.000000 | -0.750000 |  3.000000 | 5.00e+00 |
| 3 | 0.062500 | -2.000000 |  3.312500 | 3.75e+00 |
| 4 | 1.000000 | -1.218750 |  3.000000 | 3.12e+00 |
| 5 | 0.414062 | -2.000000 |  3.195312 | 2.34e+00 |
| 6 | 1.000000 | -1.511719 |  3.000000 | 1.95e+00 |
| 7 | 0.633789 | -2.000000 |  3.122070 | 1.46e+00 |
| 8 | 1.000000 | -1.694824 |  3.000000 | 1.22e+00 |
| 9 | 0.771118 | -2.000000 |  3.076294 | 9.16e-01 |
| $\vdots$ | $\vdots$ |  $\vdots$ |  $\vdots$ |  $\vdots$ |  
| 49 | 0.999981 | -2.000000 |  3.000006 | 7.57e-05 |

:::
::::
------------------

[1;31m---------------------------------------------------------------------------[0m
[1;31mFileNotFoundError[0m                         Traceback (most recent call last)
Cell [1;32mIn[1], line 194[0m
[0;32m    191[0m string [38;5;241m+[39m[38;5;241m=[39m [38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;124m:::[39m[38;5;130;01m\n[39;00m[38;5;124m::::[39m[38;5;124m"[39m
[0;32m    193[0m [38;5;28mprint[39m(string)
[1;32m--> 194[0m [43msubprocess[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mpbcopy[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[43mtext[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m[43m [49m[38;5;28;43minput[39;49m[38;5;241;43m=[39;49m[43mstring[49m[43m)[49m

File [1;32mC:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.1776.0_x64__qbz5n2kfra8p0\Lib\subprocess.py:548[0m, in [0;36mrun[1;34m(input, capture_output, timeout, check, *popenargs, **kwargs)[0m
[0;32m    545[0m     kwargs[[38;5;124m'[39m[38;5;124mstdout[39m[38;5;124m'[39m] [38;5;241m=[39m PIPE
[0;32m    546[0m     kwargs[[38;5;124m'[39m[38;5;124mstderr[39m[38;5;124m'[39m] [38;5;241m=[39m PIPE
[1;32m--> 548[0m [38;5;28;01mwith[39;00m [43mPopen[49m[43m([49m[38;5;241;43m*[39;49m[43mpopenargs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m [38;5;28;01mas[39;00m process:
[0;32m    549[0m     [38;5;28;01mtry[39;00m:
[0;32m    550[0m         stdout, stderr [38;5;241m=[39m process[38;5;241m.[39mcommunicate([38;5;28minput[39m, timeout[38;5;241m=[39mtimeout)

File [1;32mC:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.1776.0_x64__qbz5n2kfra8p0\Lib\subprocess.py:1026[0m, in [0;36mPopen.__init__[1;34m(self, args, bufsize, executable, stdin, stdout, stderr, preexec_fn, close_fds, shell, cwd, env, universal_newlines, startupinfo, creationflags, restore_signals, start_new_session, pass_fds, user, group, extra_groups, encoding, errors, text, umask, pipesize, process_group)[0m
[0;32m   1022[0m         [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtext_mode:
[0;32m   1023[0m             [38;5;28mself[39m[38;5;241m.[39mstderr [38;5;241m=[39m io[38;5;241m.[39mTextIOWrapper([38;5;28mself[39m[38;5;241m.[39mstderr,
[0;32m   1024[0m                     encoding[38;5;241m=[39mencoding, errors[38;5;241m=[39merrors)
[1;32m-> 1026[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_execute_child[49m[43m([49m[43margs[49m[43m,[49m[43m [49m[43mexecutable[49m[43m,[49m[43m [49m[43mpreexec_fn[49m[43m,[49m[43m [49m[43mclose_fds[49m[43m,[49m
[0;32m   1027[0m [43m                        [49m[43mpass_fds[49m[43m,[49m[43m [49m[43mcwd[49m[43m,[49m[43m [49m[43menv[49m[43m,[49m
[0;32m   1028[0m [43m                        [49m[43mstartupinfo[49m[43m,[49m[43m [49m[43mcreationflags[49m[43m,[49m[43m [49m[43mshell[49m[43m,[49m
[0;32m   1029[0m [43m                        [49m[43mp2cread[49m[43m,[49m[43m [49m[43mp2cwrite[49m[43m,[49m
[0;32m   1030[0m [43m                        [49m[43mc2pread[49m[43m,[49m[43m [49m[43mc2pwrite[49m[43m,[49m
[0;32m   1031[0m [43m                        [49m[43merrread[49m[43m,[49m[43m [49m[43merrwrite[49m[43m,[49m
[0;32m   1032[0m [43m                        [49m[43mrestore_signals[49m[43m,[49m
[0;32m   1033[0m [43m                        [49m[43mgid[49m[43m,[49m[43m [49m[43mgids[49m[43m,[49m[43m [49m[43muid[49m[43m,[49m[43m [49m[43mumask[49m[43m,[49m
[0;32m   1034[0m [43m                        [49m[43mstart_new_session[49m[43m,[49m[43m [49m[43mprocess_group[49m[43m)[49m
[0;32m   1035[0m [38;5;28;01mexcept[39;00m:
[0;32m   1036[0m     [38;5;66;03m# Cleanup if the child failed starting.[39;00m
[0;32m   1037[0m     [38;5;28;01mfor[39;00m f [38;5;129;01min[39;00m [38;5;28mfilter[39m([38;5;28;01mNone[39;00m, ([38;5;28mself[39m[38;5;241m.[39mstdin, [38;5;28mself[39m[38;5;241m.[39mstdout, [38;5;28mself[39m[38;5;241m.[39mstderr)):

File [1;32mC:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.1776.0_x64__qbz5n2kfra8p0\Lib\subprocess.py:1538[0m, in [0;36mPopen._execute_child[1;34m(self, args, executable, preexec_fn, close_fds, pass_fds, cwd, env, startupinfo, creationflags, shell, p2cread, p2cwrite, c2pread, c2pwrite, errread, errwrite, unused_restore_signals, unused_gid, unused_gids, unused_uid, unused_umask, unused_start_new_session, unused_process_group)[0m
[0;32m   1536[0m [38;5;66;03m# Start the process[39;00m
[0;32m   1537[0m [38;5;28;01mtry[39;00m:
[1;32m-> 1538[0m     hp, ht, pid, tid [38;5;241m=[39m [43m_winapi[49m[38;5;241;43m.[39;49m[43mCreateProcess[49m[43m([49m[43mexecutable[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m
[0;32m   1539[0m [43m                             [49m[38;5;66;43;03m# no special security[39;49;00m
[0;32m   1540[0m [43m                             [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m
[0;32m   1541[0m [43m                             [49m[38;5;28;43mint[39;49m[43m([49m[38;5;129;43;01mnot[39;49;00m[43m [49m[43mclose_fds[49m[43m)[49m[43m,[49m
[0;32m   1542[0m [43m                             [49m[43mcreationflags[49m[43m,[49m
[0;32m   1543[0m [43m                             [49m[43menv[49m[43m,[49m
[0;32m   1544[0m [43m                             [49m[43mcwd[49m[43m,[49m
[0;32m   1545[0m [43m                             [49m[43mstartupinfo[49m[43m)[49m
[0;32m   1546[0m [38;5;28;01mfinally[39;00m:
[0;32m   1547[0m     [38;5;66;03m# Child is launched. Close the parent's copy of those pipe[39;00m
[0;32m   1548[0m     [38;5;66;03m# handles that only the child should have open.  You need[39;00m
[1;32m   (...)[0m
[0;32m   1551[0m     [38;5;66;03m# pipe will not close when the child process exits and the[39;00m
[0;32m   1552[0m     [38;5;66;03m# ReadFile will hang.[39;00m
[0;32m   1553[0m     [38;5;28mself[39m[38;5;241m.[39m_close_pipe_fds(p2cread, p2cwrite,
[0;32m   1554[0m                          c2pread, c2pwrite,
[0;32m   1555[0m                          errread, errwrite)

[1;31mFileNotFoundError[0m: [WinError 2] The system cannot find the file specified

